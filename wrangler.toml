name = "test-healing-project"
main = "dist/worker.js"
compatibility_date = "2024-01-01"

# @shared alias: import from shared/ via 'import x from "@shared/db"'
[build]
command = "npx esbuild \"src/index.ts\" --bundle --outfile=dist/worker.js --format=esm --alias:@shared=./shared"

[[d1_databases]]
binding = "DB"
database_name = "local-db"
database_id = "aerostack-local"

[[kv_namespaces]]
binding = "CACHE"
id = "local-kv"

[[queues.producers]]
binding = "QUEUE"
queue = "local-queue"

[ai]
binding = "AI"

# Deploy: aerostack deploy --env staging | production
[env.staging]
[[env.staging.d1_databases]]
binding = "DB"
database_name = "local-db"
database_id = "aerostack-local"

[[env.staging.kv_namespaces]]
binding = "CACHE"
id = "local-kv"

[[env.staging.queues.producers]]
binding = "QUEUE"
queue = "local-queue"

[env.staging.ai]
binding = "AI"

[env.production]
[[env.production.d1_databases]]
binding = "DB"
database_name = "local-db"
database_id = "aerostack-local"

[[env.production.kv_namespaces]]
binding = "CACHE"
id = "local-kv"

[[env.production.queues.producers]]
binding = "QUEUE"
queue = "local-queue"

[env.production.ai]
binding = "AI"

